<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ·Ø¨ÙŠÙ‚ ØªØµØ­ÙŠØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</title>
<script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        .camera-container {
            position: relative;
            max-width: 100%;
            background: #1f2937;
            border-radius: 12px;
            overflow: hidden;
        }
        .overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 3px dashed #10b981;
            width: 80%;
            height: 60%;
            pointer-events: none;
            border-radius: 8px;
        }
        .result-animation { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .correct-answer { background: linear-gradient(135deg, #10b981, #059669); }
        .wrong-answer { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .camera-button {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            transition: all 0.3s ease;
        }
        .camera-button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-full font-sans">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ“± ØªØ·Ø¨ÙŠÙ‚ ØªØµØ­ÙŠØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h1>
            <p class="text-gray-600 text-lg">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ØªØµØ­ÙŠØ­ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
        </header>

        <main class="max-w-4xl mx-auto">
            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨
                </h2>
                
                <!-- Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ -->
                <div class="bg-blue-50 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-3">ğŸ“Š Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù…Ù„Ù Excel</h3>
                    <div class="flex flex-col sm:flex-row gap-4 mb-4">
                        <button onclick="downloadStudentsTemplate()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium flex items-center justify-center gap-2">
                            ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel
                        </button>
                        <div class="flex-1">
                            <input type="file" id="studentsFileInput" accept=".xlsx,.xls,.csv" 
                                   class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" />
                        </div>
                    </div>
                    <p class="text-sm text-blue-700">
                        ğŸ’¡ Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ÙŠÙ†: "Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" Ùˆ "Ø§Ù„ÙØµÙ„" (Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
                        <br>ğŸ“‹ ÙŠØ¯Ø¹Ù… Ù…Ù„ÙØ§Øª: .xlsx, .xls, .csv
                    </p>
                </div>

                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ -->
                <div id="studentsListSection" class="hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
                        <div class="flex gap-2">
                            <button onclick="toggleMultipleCorrection()" id="multiCorrectionBtn"
                                    class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                                ğŸ”„ ØªØµØ­ÙŠØ­ Ù…ØªØ¹Ø¯Ø¯
                            </button>
                            <button onclick="clearStudentsList()" 
                                    class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg font-medium text-sm">
                                ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                            </button>
                        </div>
                    </div>
                    
                    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-blue-100 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-blue-600" id="totalStudentsCount">0</div>
                            <div class="text-xs text-blue-800">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                        </div>
                        <div class="bg-green-100 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-green-600" id="correctedCount">0</div>
                            <div class="text-xs text-green-800">ØªÙ… ØªØµØ­ÙŠØ­Ù‡Ø§</div>
                        </div>
                        <div class="bg-yellow-100 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="pendingCount">0</div>
                            <div class="text-xs text-yellow-800">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                        </div>
                        <div class="bg-purple-100 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-purple-600" id="uniqueClassesCount">0</div>
                            <div class="text-xs text-purple-800">Ø¹Ø¯Ø¯ Ø§Ù„ÙØµÙˆÙ„</div>
                        </div>
                    </div>

                    <!-- ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø« -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label for="searchStudentName" class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…:</label>
                                <input type="text" id="searchStudentName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨..." 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       onkeyup="filterStudentsList()">
                            </div>
                            <div>
                                <label for="filterClass" class="block text-sm font-medium text-gray-700 mb-1">ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ÙØµÙ„:</label>
                                <select id="filterClass" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        onchange="filterStudentsList()">
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØµÙˆÙ„</option>
                                </select>
                            </div>
                            <div>
                                <label for="filterStatus" class="block text-sm font-medium text-gray-700 mb-1">Ø­Ø§Ù„Ø© Ø§Ù„ØªØµØ­ÙŠØ­:</label>
                                <select id="filterStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        onchange="filterStudentsList()">
                                    <option value="">Ø§Ù„ÙƒÙ„</option>
                                    <option value="corrected">ØªÙ… Ø§Ù„ØªØµØ­ÙŠØ­</option>
                                    <option value="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ -->
                    <div id="studentsList" class="space-y-2 max-h-64 overflow-y-auto">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>

                <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ -->
                <div id="currentStudentSection" class="hidden bg-green-50 rounded-lg p-4 mb-4">
                    <h3 class="text-lg font-semibold text-green-800 mb-3">ğŸ‘¤ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ</h3>
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-semibold" id="currentStudentName">-</div>
                            <div class="text-sm text-gray-600">
                                Ø§Ù„ÙØµÙ„: <span id="currentStudentClass">-</span>
                            </div>
                        </div>
                        <button onclick="selectDifferentStudent()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                            ØªØºÙŠÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ -->
            <div id="multipleCorrectionSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ”„ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
                </h2>
                
                <div class="bg-purple-50 rounded-lg p-4 mb-6">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-purple-600">ğŸ¯</span>
                        <span class="font-semibold text-purple-800">ØªØµØ­ÙŠØ­ Ø£ÙˆØ±Ø§Ù‚ Ø¹Ø¯Ø© Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„ØªØªØ§Ø¨Ø¹</span>
                    </div>
                    <p class="text-sm text-purple-700">Ø³ÙŠØªÙ… ØªØµØ­ÙŠØ­ Ø£ÙˆØ±Ø§Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹. ØµÙˆÙ‘Ø± Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ ÙˆØ³ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                </div>

                <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
                <div class="mb-6">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>Ø§Ù„ØªÙ‚Ø¯Ù…</span>
                        <span id="progressText">0 Ù…Ù† 0</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ -->
                <div id="currentMultiStudent" class="bg-blue-50 rounded-lg p-4 mb-6 hidden">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-lg font-semibold text-blue-800" id="multiStudentName">-</div>
                            <div class="text-sm text-blue-600">
                                Ø§Ù„ÙØµÙ„: <span id="multiStudentClass">-</span>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-blue-600">Ø§Ù„Ø·Ø§Ù„Ø¨ Ø±Ù‚Ù…</div>
                            <div class="text-2xl font-bold text-blue-800" id="currentStudentNumber">1</div>
                        </div>
                    </div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="startMultipleCorrection()" id="startMultiBtn"
                            class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
                    </button>
                    <button onclick="skipCurrentStudent()" id="skipStudentBtn" disabled
                            class="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed">
                        â­ï¸ ØªØ®Ø·ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨
                    </button>
                    <button onclick="pauseMultipleCorrection()" id="pauseMultiBtn" disabled
                            class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed">
                        â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª
                    </button>
                    <button onclick="stopMultipleCorrection()" id="stopMultiBtn" disabled
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed">
                        â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµØ­ÙŠØ­
                    </button>
                </div>

                <!-- ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ -->
                <div id="multiCorrectionReport" class="hidden mt-6 bg-gray-50 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯</h3>
                    <div id="multiReportContent">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                    <div class="mt-4 flex gap-4 justify-center">
                        <button onclick="exportMultiReport()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                            ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                        </button>
                        <button onclick="resetMultiCorrection()" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                            ğŸ”„ ØªØµØ­ÙŠØ­ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="questionCount" class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:</label>
                        <input type="number" id="questionCount" min="1" max="50" value="10" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="optionsCount" class="block text-sm font-medium text-gray-700 mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„:</label>
                        <select id="optionsCount" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="4">4 Ø®ÙŠØ§Ø±Ø§Øª (AØŒ BØŒ CØŒ D)</option>
                            <option value="5">5 Ø®ÙŠØ§Ø±Ø§Øª (AØŒ BØŒ CØŒ DØŒ E)</option>
                        </select>
                    </div>
                </div>
                <button onclick="generateAnswerSheet()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                    Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                </button>
            </div>

            <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© -->
            <div id="answerSheet" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:</h3>
                <div id="answersGrid" class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4"></div>
                <button onclick="saveCorrectAnswers()" 
                        class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                    Ø­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
                </button>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ“· ØªØµÙˆÙŠØ± Ø£Ùˆ ØªØ­Ù…ÙŠÙ„ ÙˆØ±Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
                </h2>
                
                <!-- Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØµÙˆÙŠØ± ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ -->
                <div class="flex flex-col sm:flex-row gap-4 mb-6">
                    <button onclick="showCameraSection()" id="cameraTabBtn"
                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors">
                        ğŸ“¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                    </button>
                    <button onclick="showUploadSection()" id="uploadTabBtn"
                            class="flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors">
                        ğŸ“ ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©
                    </button>
                </div>

                <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
                <div id="cameraSection">
                    <div class="camera-container mb-4">
                        <video id="camera" autoplay playsinline class="w-full h-80 object-cover"></video>
                        <canvas id="canvas" class="hidden"></canvas>
                        <div class="overlay"></div>
                        <div class="absolute top-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-lg text-sm">
                            Ø¶Ø¹ ÙˆØ±Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ù†Ù‚Ø·
                        </div>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button onclick="startCamera()" id="startBtn"
                                class="camera-button text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                            ğŸ“¹ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                        </button>
                        <button onclick="captureImage()" id="captureBtn" disabled
                                class="bg-gray-400 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:cursor-not-allowed">
                            ğŸ“¸ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                        </button>
                        <button onclick="stopCamera()" id="stopBtn" disabled
                                class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:cursor-not-allowed disabled:bg-gray-400">
                            â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                        </button>
                    </div>
                </div>

                <!-- Ù‚Ø³Ù… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± -->
                <div id="uploadSection" class="hidden">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 border-t pt-4">ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© ÙˆØ±Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©:</h3>
                    <input type="file" id="imageInput" accept="image/*" class="w-full text-sm text-gray-500
                        file:mr-4 file:py-2 file:px-4
                        file:rounded-full file:border-0
                        file:text-sm file:font-semibold
                        file:bg-blue-50 file:text-blue-700
                        hover:file:bg-blue-100" />

                    <div id="imagePreviewContainer" class="mt-4 hidden border border-gray-300 rounded-lg p-2 max-h-96 overflow-y-auto">
                        <img id="imagePreview" class="w-full h-auto object-contain rounded-lg" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© ØµÙˆØ±Ø© ÙˆØ±Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©" />
                    </div>

                    <div class="text-center mt-4">
                        <button onclick="processUploadedImage()" id="processUploadBtn" disabled
                                class="bg-gray-400 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 mx-auto disabled:cursor-not-allowed">
                            ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­Ù…Ù„Ø©
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø© -->
            <div id="capturedSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø©:</h3>
                <img id="capturedImage" class="w-full max-w-md mx-auto rounded-lg shadow-md mb-4">
                <div class="text-center">
                    <button onclick="processAnswers()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium">
                        ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                    </button>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
            <div id="studentInfoSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨:</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
                        <input type="text" id="studentName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="studentClass" class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ÙØµÙ„:</label>
                        <input type="text" id="studentClass" placeholder="Ø§Ù„ÙØµÙ„"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="examName" class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</label>
                        <input type="text" id="examName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="examDate" class="block text-sm font-medium text-gray-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</label>
                        <input type="date" id="examDate" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
            <div id="verificationSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ” Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-yellow-600">âš ï¸</span>
                        <span class="font-semibold text-yellow-800">ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø© ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­ØªÙ‡Ø§</span>
                    </div>
                    <p class="text-sm text-yellow-700">Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¨Ø¹Ø¶ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ù„Ù„ØªØµØ­ÙŠØ­ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† ÙˆØ§Ø¶Ø­Ø© ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©</p>
                </div>
                
                <div id="verificationGrid" class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"></div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="confirmAnswers()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
                    </button>
                    <button onclick="manualEntry()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        âœï¸ Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ
                    </button>
                </div>
            </div>

            <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµØ­ÙŠØ­ -->
            <div id="resultsSection" class="bg-white rounded-xl shadow-lg p-6 hidden result-animation">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØµØ­ÙŠØ­</h3>
                
                <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
                <div id="studentResultInfo" class="bg-gray-50 rounded-lg p-4 mb-6 hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div><strong>Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> <span id="resultStudentName">-</span></div>
                        <div><strong>Ø§Ù„ÙØµÙ„:</strong> <span id="resultStudentClass">-</span></div>
                        <div><strong>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</strong> <span id="resultExamName">-</span></div>
                        <div><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> <span id="resultExamDate">-</span></div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="correctCount">0</div>
                        <div class="text-sm">Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©</div>
                    </div>
                    <div class="bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="wrongCount">0</div>
                        <div class="text-sm">Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©</div>
                    </div>
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="scorePercentage">0%</div>
                        <div class="text-sm">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold" id="letterGrade">-</div>
                        <div class="text-sm">Ø§Ù„ØªÙ‚Ø¯ÙŠØ±</div>
                    </div>
                </div>

                <div id="detailedResults" class="grid grid-cols-2 md:grid-cols-5 gap-3 mb-6"></div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="exportResults()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                    </button>
                    <button onclick="saveToHistory()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        ğŸ’¾ Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
                    </button>
                    <button onclick="resetApp()" 
                            class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2">
                        ğŸ”„ ØªØµØ­ÙŠØ­ ÙˆØ±Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>
            </div>

             <!-- Ø³Ø¬Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
             <div id="historySection" class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ“š Ø³Ø¬Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
                    <div class="flex gap-2">
                        <button onclick="exportAllResults()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg font-medium text-sm">
                            ğŸ“Š ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„
                        </button>
                        <button onclick="toggleHistory()" id="historyToggle"
                                class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                            Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„
                        </button>
                    </div>
                </div>
                <div id="historyContent" class="hidden">
                    <div id="historyList" class="space-y-3">
                        <div class="text-center text-gray-500 py-8">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯
                        </div>
                    </div>
                    <div class="text-center mt-4">
                        <button onclick="clearHistory()" 
                                class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium text-sm">
                            ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let isMultipleCorrectionMode = false;
        let multiCorrectionQueue = [];
        let currentMultiIndex = 0;
        let multiCorrectionResults = [];
        let correctAnswers = [];
        let studentAnswers = [];
        let stream = null;
        let startTime = null;
        let resultsHistory = JSON.parse(localStorage.getItem('examResults') || '[]');
        let studentsList = JSON.parse(localStorage.getItem('studentsList') || '[]');
        let currentStudent = null;

        // --- Core UI Functions ---
        function generateAnswerSheet() {
            const questionCount = parseInt(document.getElementById('questionCount').value);
            const optionsCount = parseInt(document.getElementById('optionsCount').value);
            const answersGrid = document.getElementById('answersGrid');
            answersGrid.innerHTML = '';
            const options = optionsCount === 4 ? ['A', 'B', 'C', 'D'] : ['A', 'B', 'C', 'D', 'E'];
            for (let i = 1; i <= questionCount; i++) {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-gray-50 p-3 rounded-lg';
                questionDiv.innerHTML = `
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø³Ø¤Ø§Ù„ ${i}:</label>
                    <select id="answer${i}" class="w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</option>
                        ${options.map(opt => `<option value="${opt}" ${opt === 'A' ? 'selected' : ''}>${opt}</option>`).join('')}
                    </select>
                `;
                answersGrid.appendChild(questionDiv);
            }
            document.getElementById('answerSheet').classList.remove('hidden');
        }

        function saveCorrectAnswers() {
            const questionCount = parseInt(document.getElementById('questionCount').value);
            correctAnswers = [];
            for (let i = 1; i <= questionCount; i++) {
                const answer = document.getElementById(`answer${i}`).value;
                if (!answer) {
                    showNotification(`ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø© Ù„Ù„Ø³Ø¤Ø§Ù„ ${i}`, 'error');
                    return;
                }
                correctAnswers.push(answer);
            }
            document.getElementById('studentInfoSection').classList.remove('hidden');
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©!', 'success');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg text-white font-medium z-50 transition-all duration-300 ${
                type === 'success' ? 'bg-green-600' : type === 'error' ? 'bg-red-600' : 'bg-blue-600'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -100%)';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        function resetApp() {
            document.getElementById('capturedSection').classList.add('hidden');
            document.getElementById('verificationSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.add('hidden');
            document.getElementById('studentInfoSection').classList.add('hidden');
            if(document.getElementById('studentResultInfo')) document.getElementById('studentResultInfo').classList.add('hidden');
            document.getElementById('studentName').value = '';
            document.getElementById('studentClass').value = '';
            document.getElementById('examName').value = '';
            document.getElementById('examDate').value = new Date().toISOString().split('T')[0];
            studentAnswers = [];
            startTime = null;
            if (isMultipleCorrectionMode) {
                handleMultiCorrectionNext({});
            }
            showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.', 'info');
        }

        // --- Camera and Image Upload Functions ---
        async function startCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } } 
                });
                document.getElementById('camera').srcObject = stream;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('captureBtn').disabled = false;
                document.getElementById('captureBtn').className = 'bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
                document.getElementById('stopBtn').disabled = false;
                document.getElementById('stopBtn').className = 'bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
            } catch (error) {
                showNotification('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§.', 'error');
            }
        }

        function captureImage() {
            const video = document.getElementById('camera');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            document.getElementById('capturedImage').src = canvas.toDataURL('image/jpeg', 0.9);
            document.getElementById('capturedSection').classList.remove('hidden');
            stopCamera();
        }

        function stopCamera() {
            if (stream) stream.getTracks().forEach(track => track.stop());
            stream = null;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('captureBtn').disabled = true;
            document.getElementById('captureBtn').className = 'bg-gray-400 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:cursor-not-allowed';
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('stopBtn').className = 'bg-gray-400 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 disabled:cursor-not-allowed';
        }

        function showCameraSection() {
            document.getElementById('cameraSection').classList.remove('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('cameraTabBtn').className = 'flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
            document.getElementById('uploadTabBtn').className = 'flex-1 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
        }

        function showUploadSection() {
            document.getElementById('cameraSection').classList.add('hidden');
            document.getElementById('uploadSection').classList.remove('hidden');
            document.getElementById('cameraTabBtn').className = 'flex-1 bg-gray-600 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
            document.getElementById('uploadTabBtn').className = 'flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg font-medium flex items-center justify-center gap-2';
            if (stream) stopCamera();
        }

        // --- AI Processing ---
        async function processImageWithAI(imageSrc) {
            showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...', 'info');
            const res = await fetch(imageSrc);
            const blob = await res.blob();
            const formData = new FormData();
            formData.append('image', blob, 'answer_sheet.jpg');
            formData.append('num_questions', document.getElementById('questionCount').value);
            formData.append('options_per_q', document.getElementById('optionsCount').value);

            const response = await fetch('/api/correct', {
                method: 'POST',
                body: formData
            });

            if (!response.ok) {
                const errData = await response.json();
                throw new Error(errData.error || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…');
            }

            const data = await response.json();
            if (!data.success) throw new Error(data.error || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„');
            return data.answers;
        }

        function processAnswers() {
            if (correctAnswers.length === 0) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ø£ÙˆÙ„Ø§Ù‹!', 'error'); return;
            }
            startTime = Date.now();
            const imageSrc = document.getElementById('capturedImage').src;
            processImageWithAI(imageSrc)
                .then(results => {
                    studentAnswers = results;
                    showAnswerVerification();
                })
                .catch(err => showNotification(`ÙØ´Ù„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: ${err.message}`, 'error'));
        }

        function processUploadedImage() {
            if (correctAnswers.length === 0) {
                 showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ø£ÙˆÙ„Ø§Ù‹!', 'error'); return;
            }
            startTime = Date.now();
            const imageSrc = document.getElementById('imagePreview').src;
            processImageWithAI(imageSrc)
                .then(results => {
                    studentAnswers = results;
                    showAnswerVerification();
                })
                .catch(err => showNotification(`ÙØ´Ù„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: ${err.message}`, 'error'));
        }

        // --- Answer Verification and Results Display ---
        function showAnswerVerification() {
            const verificationGrid = document.getElementById('verificationGrid');
            const optionsCount = parseInt(document.getElementById('optionsCount').value);
            const options = optionsCount === 4 ? ['A', 'B', 'C', 'D'] : ['A', 'B', 'C', 'D', 'E'];
            verificationGrid.innerHTML = '';

            for (let i = 0; i < correctAnswers.length; i++) {
                const questionDiv = document.createElement('div');
                questionDiv.className = `p-4 rounded-lg border-2 ${studentAnswers[i] === 'ÙØ±Ø§Øº' ? 'border-orange-300 bg-orange-50' : 'border-blue-300 bg-blue-50'}`;
                questionDiv.innerHTML = `
                    <div class="text-center mb-3 text-sm font-medium text-gray-700">Ø§Ù„Ø³Ø¤Ø§Ù„ ${i + 1}</div>
                    <div class="text-center mb-3 text-2xl font-bold">${studentAnswers[i]}</div>
                    <select id="verify${i}" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">
                        <option value="ÙØ±Ø§Øº" ${studentAnswers[i] === 'ÙØ±Ø§Øº' ? 'selected' : ''}>ÙØ±Ø§Øº</option>
                        ${options.map(opt => `<option value="${opt}" ${opt === studentAnswers[i] ? 'selected' : ''}>${opt}</option>`).join('')}
                    </select>
                `;
                verificationGrid.appendChild(questionDiv);
            }
            document.getElementById('verificationSection').classList.remove('hidden');
        }

        function confirmAnswers() {
            for (let i = 0; i < correctAnswers.length; i++) {
                studentAnswers[i] = document.getElementById(`verify${i}`).value;
            }
            document.getElementById('verificationSection').classList.add('hidden');
            displayResults();
        }

        function manualEntry() {
            studentAnswers = Array(correctAnswers.length).fill('');
            showAnswerVerification();
            showNotification('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹.', 'info');
        }
        
        function displayResults() {
            let correctCount = 0, wrongCount = 0;
            const detailedResults = document.getElementById('detailedResults');
            detailedResults.innerHTML = '';

            for (let i = 0; i < correctAnswers.length; i++) {
                const isCorrect = studentAnswers[i] === correctAnswers[i];
                if (isCorrect) correctCount++; else wrongCount++;
                
                const resultDiv = document.createElement('div');
                resultDiv.className = `p-3 rounded-lg text-white text-center font-medium ${isCorrect ? 'correct-answer' : 'wrong-answer'}`;
                resultDiv.innerHTML = `
                    <div class="text-sm">Ø³${i + 1}</div>
                    <div class="text-lg">${studentAnswers[i] || 'ÙØ±Ø§Øº'}</div>
                    <div class="text-xs">${isCorrect ? 'âœ“' : `âœ— (${correctAnswers[i]})`}</div>
                `;
                detailedResults.appendChild(resultDiv);
            }

            const percentage = Math.round((correctCount / correctAnswers.length) * 100);
            const getGrade = p => {
                if (p >= 90) return 'Ù…Ù…ØªØ§Ø²'; if (p >= 80) return 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹';
                if (p >= 70) return 'Ø¬ÙŠØ¯'; if (p >= 60) return 'Ù…Ù‚Ø¨ÙˆÙ„'; return 'Ø±Ø§Ø³Ø¨';
            };

            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('wrongCount').textContent = wrongCount;
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
            document.getElementById('letterGrade').textContent = getGrade(percentage);
            updateStudentResultInfo();
            document.getElementById('resultsSection').classList.remove('hidden');
        }
        
        function updateStudentResultInfo() {
            const studentName = document.getElementById('studentName').value;
            const studentClass = document.getElementById('studentClass').value;
            const examName = document.getElementById('examName').value;
            const examDate = document.getElementById('examDate').value;
            
            if (studentName || studentClass || examName || examDate) {
                document.getElementById('resultStudentName').textContent = studentName || '-';
                document.getElementById('resultStudentClass').textContent = studentClass || '-';
                document.getElementById('resultExamName').textContent = examName || '-';
                document.getElementById('resultExamDate').textContent = examDate || '-';
                document.getElementById('studentResultInfo').classList.remove('hidden');
            }
        }
        
        // --- History and Export ---
        function saveToHistory() {
            const result = {
                id: Date.now(),
                studentName: document.getElementById('studentName').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                studentClass: document.getElementById('studentClass').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                examName: document.getElementById('examName').value || 'Ø§Ø®ØªØ¨Ø§Ø±',
                examDate: document.getElementById('examDate').value,
                correctCount: document.getElementById('correctCount').textContent,
                wrongCount: document.getElementById('wrongCount').textContent,
                percentage: document.getElementById('scorePercentage').textContent,
                grade: document.getElementById('letterGrade').textContent,
                timestamp: new Date().toLocaleString('ar-SA')
            };
            resultsHistory.unshift(result);
            localStorage.setItem('examResults', JSON.stringify(resultsHistory));
            updateStudentCorrectionStatus(result);
            if(isMultipleCorrectionMode) handleMultiCorrectionNext(result);
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„!', 'success');
        }

        function toggleHistory() {
            const historyContent = document.getElementById('historyContent');
            const toggleBtn = document.getElementById('historyToggle');
            if (historyContent.classList.contains('hidden')) {
                historyContent.classList.remove('hidden');
                toggleBtn.textContent = 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø³Ø¬Ù„';
                updateHistoryDisplay();
            } else {
                historyContent.classList.add('hidden');
                toggleBtn.textContent = 'Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„';
            }
        }

        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            if (resultsHistory.length === 0) {
                historyList.innerHTML = '<div class="text-center text-gray-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';
                return;
            }
            historyList.innerHTML = resultsHistory.map(r => `
                <div class="bg-gray-50 rounded-lg p-4 border-r-4 border-blue-500">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-semibold">${r.studentName}</h4>
                            <p class="text-sm text-gray-600">${r.examName}</p>
                        </div>
                        <div class="text-left">
                            <div class="text-lg font-bold text-blue-600">${r.percentage}</div>
                            <div class="text-sm text-gray-600">${r.grade}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">${r.timestamp}</div>
                </div>
            `).join('');
        }

        function clearHistory() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ')) {
                resultsHistory = [];
                localStorage.removeItem('examResults');
                updateHistoryDisplay();
                showNotification('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„.', 'success');
            }
        }
        
        function exportResults() {
            const data = [
                ['Ø§Ù„Ø·Ø§Ù„Ø¨', document.getElementById('studentName').value],
                ['Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', document.getElementById('examName').value],
                ['Ø§Ù„Ø¯Ø±Ø¬Ø©', document.getElementById('scorePercentage').textContent],
                ['Ø§Ù„ØªÙ‚Ø¯ÙŠØ±', document.getElementById('letterGrade').textContent]
            ];
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ø§Ù„Ù†ØªÙŠØ¬Ø©');
            XLSX.writeFile(wb, 'Ù†ØªÙŠØ¬Ø©_Ø§Ù„Ø·Ø§Ù„Ø¨.xlsx');
        }
        
        function exportAllResults() {
             if (resultsHistory.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§!', 'error');
                return;
            }
            const data = resultsHistory.map(r => ({
                'Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨': r.studentName,
                'Ø§Ù„ÙØµÙ„': r.studentClass,
                'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±': r.examName,
                'Ø§Ù„ØªØ§Ø±ÙŠØ®': r.examDate,
                'Ø§Ù„Ø¯Ø±Ø¬Ø©': r.percentage,
                'Ø§Ù„ØªÙ‚Ø¯ÙŠØ±': r.grade,
                'ÙˆÙ‚Øª Ø§Ù„ØªØµØ­ÙŠØ­': r.timestamp
            }));
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬');
            XLSX.writeFile(wb, 'Ø¬Ù…ÙŠØ¹_Ø§Ù„Ù†ØªØ§Ø¦Ø¬.xlsx');
        }

        // --- Student Management ---
        function downloadStudentsTemplate() {
            const data = [['Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨', 'Ø§Ù„ÙØµÙ„'], ['Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯', '1-Ø£']];
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ø§Ù„Ø·Ù„Ø§Ø¨');
            XLSX.writeFile(wb, 'Ù†Ù…ÙˆØ°Ø¬_Ø§Ù„Ø·Ù„Ø§Ø¨.xlsx');
        }

        function parseStudentsFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const ws = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(ws, {header: 1});
                
                const newStudents = jsonData.slice(1).map((row, index) => ({
                    id: Date.now() + index,
                    name: row[0],
                    studentId: `ST${String(Date.now() + index).slice(-6)}`,
                    class: row[1],
                    corrected: false, result: null, timestamp: null
                })).filter(s => s.name && s.class);

                studentsList.push(...newStudents);
                localStorage.setItem('studentsList', JSON.stringify(studentsList));
                displayStudentsList();
                showNotification(`ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${newStudents.length} Ø·Ø§Ù„Ø¨.`, 'success');
            };
            reader.readAsArrayBuffer(file);
        }

        function displayStudentsList() {
            const studentsListSection = document.getElementById('studentsListSection');
            if (studentsList.length === 0) {
                studentsListSection.classList.add('hidden');
                return;
            }
            studentsListSection.classList.remove('hidden');
            updateStudentsStats();
            updateClassFilter();
            filterStudentsList();
        }

        function updateStudentsStats() {
            document.getElementById('totalStudentsCount').textContent = studentsList.length;
            document.getElementById('correctedCount').textContent = studentsList.filter(s => s.corrected).length;
            document.getElementById('pendingCount').textContent = studentsList.filter(s => !s.corrected).length;
            document.getElementById('uniqueClassesCount').textContent = new Set(studentsList.map(s => s.class)).size;
        }
        
        function updateClassFilter() {
            const filterClass = document.getElementById('filterClass');
            const uniqueClasses = [...new Set(studentsList.map(s => s.class))];
            filterClass.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØµÙˆÙ„</option>' +
                uniqueClasses.map(cls => `<option value="${cls}">${cls}</option>`).join('');
        }
        
        function filterStudentsList() {
            const searchTerm = document.getElementById('searchStudentName').value.toLowerCase();
            const classFilter = document.getElementById('filterClass').value;
            const statusFilter = document.getElementById('filterStatus').value;

            let filtered = studentsList
                .filter(s => s.name.toLowerCase().includes(searchTerm))
                .filter(s => !classFilter || s.class === classFilter)
                .filter(s => !statusFilter || (statusFilter === 'corrected' ? s.corrected : !s.corrected));
            
            displayFilteredStudents(filtered);
        }

        function displayFilteredStudents(students) {
            const container = document.getElementById('studentsList');
            if (students.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 p-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</div>';
                return;
            }
            container.innerHTML = students.map(s => `
                <div class="flex items-center justify-between p-3 rounded-lg ${s.corrected ? 'bg-green-50' : 'bg-gray-50'}">
                    <div>
                        <div class="font-semibold">${s.name}</div>
                        <div class="text-sm text-gray-600">${s.class}</div>
                    </div>
                    <div>
                        ${!s.corrected ? `<button onclick="selectStudent(${s.id})" class="bg-blue-600 text-white px-3 py-1 rounded text-sm">Ø§Ø®ØªÙŠØ§Ø±</button>` : ''}
                    </div>
                </div>
            `).join('');
        }
        
        function selectStudent(studentId) {
            currentStudent = studentsList.find(s => s.id === studentId);
            if (!currentStudent) return;
            document.getElementById('studentName').value = currentStudent.name;
            document.getElementById('studentClass').value = currentStudent.class;
            
            document.getElementById('currentStudentName').textContent = currentStudent.name;
            document.getElementById('currentStudentClass').textContent = currentStudent.class;
            document.getElementById('currentStudentSection').classList.remove('hidden');
        }

        function selectDifferentStudent() {
            currentStudent = null;
            document.getElementById('currentStudentSection').classList.add('hidden');
            document.getElementById('studentName').value = '';
            document.getElementById('studentClass').value = '';
        }
        
        function clearStudentsList() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ØŸ')) {
                studentsList = [];
                localStorage.removeItem('studentsList');
                displayStudentsList();
            }
        }
        
        function updateStudentCorrectionStatus(result) {
            const student = studentsList.find(s => s.name === result.studentName && s.class === result.studentClass);
            if (student) {
                student.corrected = true;
                student.result = { percentage: result.percentage, grade: result.grade };
                student.timestamp = result.timestamp;
                localStorage.setItem('studentsList', JSON.stringify(studentsList));
                filterStudentsList();
            }
        }
        
        // --- Multiple Correction Mode ---
        function toggleMultipleCorrection() {
             const section = document.getElementById('multipleCorrectionSection');
             if (section.classList.contains('hidden')) {
                 if (studentsList.filter(s => !s.corrected).length === 0) {
                     showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙˆØ±Ø§Ù‚ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØµØ­ÙŠØ­!', 'error'); return;
                 }
                 section.classList.remove('hidden');
                 setupMultipleCorrection();
             } else {
                 section.classList.add('hidden');
             }
        }
        
        function setupMultipleCorrection() {
            multiCorrectionQueue = studentsList.filter(s => !s.corrected);
            currentMultiIndex = 0;
            multiCorrectionResults = [];
            updateMultiCorrectionProgress();
        }
        
        function startMultipleCorrection() {
             if (correctAnswers.length === 0) {
                 showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ø£ÙˆÙ„Ø§Ù‹!', 'error'); return;
             }
             isMultipleCorrectionMode = true;
             currentMultiIndex = 0;
             document.getElementById('startMultiBtn').disabled = true;
             document.getElementById('skipStudentBtn').disabled = false;
             document.getElementById('stopMultiBtn').disabled = false;
             showCurrentMultiStudent();
        }
        
        function showCurrentMultiStudent() {
            if (currentMultiIndex >= multiCorrectionQueue.length) {
                completeMultipleCorrection(); return;
            }
            const student = multiCorrectionQueue[currentMultiIndex];
            document.getElementById('multiStudentName').textContent = student.name;
            document.getElementById('multiStudentClass').textContent = student.class;
            document.getElementById('currentStudentNumber').textContent = currentMultiIndex + 1;
            document.getElementById('currentMultiStudent').classList.remove('hidden');
            document.getElementById('studentName').value = student.name;
            document.getElementById('studentClass').value = student.class;
            updateMultiCorrectionProgress();
        }

        function updateMultiCorrectionProgress() {
            const progress = (currentMultiIndex / multiCorrectionQueue.length) * 100;
            document.getElementById('progressText').textContent = `${currentMultiIndex} / ${multiCorrectionQueue.length}`;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function skipCurrentStudent() {
            if (currentMultiIndex < multiCorrectionQueue.length) {
                multiCorrectionResults.push({ student: multiCorrectionQueue[currentMultiIndex], status: 'skipped' });
                currentMultiIndex++;
                showCurrentMultiStudent();
            }
        }
        
        function stopMultipleCorrection() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ØŸ')) {
                 isMultipleCorrectionMode = false;
                 document.getElementById('multipleCorrectionSection').classList.add('hidden');
            }
        }

        function handleMultiCorrectionNext(result) {
            multiCorrectionResults.push({ student: multiCorrectionQueue[currentMultiIndex], status: 'completed', result });
            currentMultiIndex++;
            if (currentMultiIndex < multiCorrectionQueue.length) {
                showCurrentMultiStudent();
                resetApp();
            } else {
                completeMultipleCorrection();
            }
        }

        function completeMultipleCorrection() {
            isMultipleCorrectionMode = false;
            generateMultiCorrectionReport();
            showNotification('Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯!', 'success');
        }
        
        function generateMultiCorrectionReport() {
            const reportContent = document.getElementById('multiReportContent');
            reportContent.innerHTML = `
                <div class="space-y-2 max-h-64 overflow-y-auto">
                ${multiCorrectionResults.map(r => `
                    <div class="flex justify-between p-2 rounded ${r.status === 'completed' ? 'bg-green-100' : 'bg-yellow-100'}">
                        <span>${r.student.name}</span>
                        <span>${r.status === 'completed' ? r.result.percentage : 'ØªÙ… Ø§Ù„ØªØ®Ø·ÙŠ'}</span>
                    </div>
                `).join('')}
                </div>
            `;
            document.getElementById('multiCorrectionReport').classList.remove('hidden');
        }

        function exportMultiReport() {
            const data = multiCorrectionResults.map(r => ({
                'Ø§Ù„Ø·Ø§Ù„Ø¨': r.student.name, 'Ø§Ù„Ø­Ø§Ù„Ø©': r.status, 'Ø§Ù„Ø¯Ø±Ø¬Ø©': r.result?.percentage || '-'
            }));
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯');
            XLSX.writeFile(wb, 'ØªÙ‚Ø±ÙŠØ±_Ø§Ù„ØªØµØ­ÙŠØ­_Ø§Ù„Ù…ØªØ¹Ø¯Ø¯.xlsx');
        }
        
        // --- DOMContentLoaded ---
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('examDate').value = new Date().toISOString().split('T')[0];
            displayStudentsList();
            updateHistoryDisplay();

            document.getElementById('studentsFileInput').addEventListener('change', e => {
                if (e.target.files[0]) parseStudentsFile(e.target.files[0]);
            });

            document.getElementById('imageInput').addEventListener('change', e => {
                if (e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        document.getElementById('imagePreview').src = ev.target.result;
                        document.getElementById('imagePreviewContainer').classList.remove('hidden');
                        document.getElementById('processUploadBtn').disabled = false;
                        document.getElementById('processUploadBtn').className = 'bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 mx-auto';
                    };
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        });
    </script>
</body>
</html>

